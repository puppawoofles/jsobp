<!doctype html>
<html>

<head>
<meta charset="UTF-8">

<link rel="stylesheet" href="ct-og.css" />
<style type="text/css"></style>



	<!-- Load code at the top -->
	<script src="woof.js"></script>
	<script src="woofui.js"></script>
	<script src="ct-og.js"></script>
</head>

<body wt="TargetController"  console-selector=".message_log"
		wh-c=".ConsoleCommand>TestConsole.OnConsoleCommand,
			  .contextmenu>InfoPanel.OnInfoClick,
			  Window.hashchange>InfoPanel.OnHashChange,
			  .click>DomHighlighter.OnClick"
	    wh-b="Target.click>TargetController.OnTargetClick">
	<div class="debug_wrapper">
		<!-- Debug stuff here. -->
		<div class="debug_panel" compendium="test/test">
		</div>
		<div class="info_panel_widget">
			<div class="info_panel_contents"></div>
		</div>
		<div class="console_widget"></div>

		<!-- Main screen here. -->
		<div class="main_screen" purpose="main_screen">

		</div>
	</div>
	
	<!-- Temporary holding cell for screens not in use. -->
	<div class="holding_area" purpose="hidden">
	
	</div>	
	<!-- Holding cell for where we keep game data (not state) -->
	<div class="compendium">
		
		<test hash="test">
			<info-panel>
				<h2> Test Content </h2>
 				I am test content.
			</info-panel>
		</test>
		
		<concept hash="unit">
			<info-panel>
				<h2> Unit </h2>
				These are the things you fight.
			</info-panel>
			
			<blueprints>
				
				<unit-blueprint name="goodboy">
					<icon ref="GOOD_BOY"></icon>
				</unit-blueprint>
				
				<unit-blueprint name="fighter">
					<icon ref="FIGHTER"></icon>								
					<info>
						<trigger wt="Trigger" priority="20" active-test="SumTrigger.Of" sum="15" renderer="TriggerRenderer.Sum">
							<move-ref ref="Strike"></move-ref>
						</trigger>
						
						<trigger wt="Trigger" priority="20" active-test="SumTrigger.Of" sum="15" renderer="TriggerRenderer.Sum">
							<move-ref ref="Defend"></move-ref>
						</trigger>
					</info>					
				</unit-blueprint>

				<unit-blueprint name="rogue">
					<icon ref="ROGUE"></icon>
					<info>
						<trigger wt="Trigger" priority="20" active-test="SetTrigger.ActiveByRank" match-on="rank" renderer="TriggerRenderer.Set">
							<move-ref ref="Multistrike">
							</move-ref>
						</trigger>
						
						<trigger wt="Trigger" priority="20" active-test="SetTrigger.ActiveByRank" match-on="rank" renderer="TriggerRenderer.Set">
							<move-ref ref="Walk"></move-ref>
						</trigger>
					</info>
				</unit-blueprint>

				<unit-blueprint name="cleric">
					<icon ref="CLERIC"></icon>								
				</unit-blueprint>

				<unit-blueprint name="wizard">
					<icon ref="WIZARD"></icon>								
				</unit-blueprint>
						
				<unit-blueprint name="goblin">
					<icon ref="GOBLIN"></icon>
					<info>
					
					</info>
				</unit-blueprint>

				<unit-blueprint name="orc">
					<icon ref="ONI"></icon>
					<info>
						<trigger wt="Trigger" priority="20" active-test="SetTrigger.ActiveBySuit" match-on="suit" renderer="TriggerRenderer.Set" min-cards="3">
							<!-- You want this to be an enrage buff instead. -->
							<move-ref ref="Multistrike">
						</trigger>					
					</info>
				</unit-blueprint>
			</blueprints>
		</concept>
		
		
		<concept hash="move">
			<info-panel>
				<h2> Move </h2>
				You use moves by playing cards.
			</info-panel>
			
			<blueprints>
				<move-blueprint name="Walk">
					<params fn="StepMove.ToParams"></params>
					<targets fn="StepMove.ToTargets"></targets>
					<evoker fn="StepMove.Evoke"></evoker>
					<score fn="StepMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Step">
					<params fn="StepMove.ToShiftParams"></params>
					<targets fn="StepMove.ToTargets"></targets>
					<evoker fn="StepMove.Evoke"></evoker>
					<score fn="StepMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Swap">
					<params fn="SwapMove.ToParams"></params>
					<targets fn="SwapMove.ToTargets"></targets>
					<evoker fn="SwapMove.Evoke"></evoker>
					<score fn="SwapMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Strike">
					<params fn="StrikeMove.ToParams"></params>
					<targets fn="StrikeMove.ToTargets"></targets>
					<evoker fn="StrikeMove.Evoke"></evoker>
					<score fn="StrikeMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Shout">
					<params fn="ShoutMove.ToParams"></params>
					<targets fn="ShoutMove.ToTargets"></targets>
					<evoker fn="ShoutMove.Evoke"></evoker>
					<score fn="ShoutMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Multistrike">
					<params fn="MultistrikeMove.ToParams"></params>
					<targets fn="MultistrikeMove.ToTargets"></targets>
					<evoker fn="MultistrikeMove.Evoke"></evoker>
					<score fn="MultistrikeMove.Score"></score>
				</move-blueprint>
				
				<move-blueprint name="Defend">
					<params fn="DefendMove.ToParams"></params>
					<targets fn="DefendMove.ToTargets"></targets>
					<evoker fn="DefendMove.Evoke"></evoker>
					<score fn="DefendMove.Score"></score>
				</move-blueprint>
			</blueprints>
			
		</concept>
		
		<concept hash="card">
			<info-panel>
				<h2> Card </h2>
				You play these on your turn.			
			</info-panel>
			
			<values>
				<card-set ranks="1 2 3 4 5 6 7 8 9 10 11 12 13" suits="spade heart diamond club"></card-set>
				<extra-card rank="0" suit="joker"></extra-card>
				<extra-card rank="0" suit="joker"></extra-card>
			</values>
			
			<concept hash="rank">
				<info-panel>
					<h2> Card - Rank </h2>
					Describe ranks here.
				</info-panel>
				<values>
					<rank value="0" icon="X"></rank>
					<rank value="1" type="standard" icon="A"> </rank>
					<rank value="2" type="standard" icon="2"> </rank>
					<rank value="3" type="standard" icon="3"> </rank>
					<rank value="4" type="standard" icon="4"> </rank>
					<rank value="5" type="standard" icon="5"> </rank>
					<rank value="6" type="standard" icon="6"> </rank>
					<rank value="7" type="standard" icon="7"> </rank>
					<rank value="8" type="standard" icon="8"> </rank>
					<rank value="9" type="standard" icon="9"> </rank>
					<rank value="10" type="standard" icon="10"> </rank>
					<rank value="11" type="standard" icon="J"> </rank>
					<rank value="12" type="standard" icon="Q"> </rank>
					<rank value="13" type="standard" icon="K"> </rank>
				</values>
			</concept>
			
			<concept hash="suit">
				<info-panel>
					<h2> Card - Suit </h2>
					Describe suits here.
				</info-panel>
				<values>
					<suit value="joker" type="bonus" icon="🐶"> </suit>
					<suit value="spade" type="standard" icon="♠️"> </suit>
					<suit value="heart" type="standard" icon="♥"> </suit>
					<suit value="diamond" type="standard" icon="♦"> </suit>
					<suit value="club" type="standard" icon="♣️"> </suit>
				</values>
			</concept>
		</concept>		
	</div>	

	<!-- Put them all in one place to hide them. -->
	<div class="templates">
		
		<!-- Icons -->
		<template name="icon_single_card">
			<div class="icon_single_card CLASSES">
				<div class="sub-icon sub-icon1 KONTENT1CLASSES">CONTENT1</div>
				<div class="slash">/</div>
				<div class="sub-icon sub-icon2 KONTENT2CLASSES">CONTENT2</div>
			</div>
		</template>
		
		<template name="icon_card_set_middle">
			<div class="icon_set_card CLASSES">
			   <div class="icon_single_card first_child"></div>
			   <div class="icon_single_card second_child"></div>
			   <div class="icon_single_card third_child">
				<div class="sub-icon sub-icon1 KONTENT1CLASSES">CONTENT1</div>
				<div class="slash">/</div>
				<div class="sub-icon sub-icon2 KONTENT2CLASSES">CONTENT2</div></div>
			</div>
		</template>
		
		<template name="icon_sum_card">
			<div class="icon_sum_card CLASSES">
			   <div class="icon_single_card first_child"></div>
			   <div class="icon_single_card second_child"></div>
			   <div class="icon_single_card third_child">
				<div class="sub-icon sub-icon1 KONTENT1CLASSES">CONTENT1</div>
				<div class="slash">/</div>
				<div class="sub-icon sub-icon2 KONTENT2CLASSES">CONTENT2</div></div>
			</div>
		</template>
		
		<template name="icon_card_sum">
			<div class="icon_card_sum">
			</div>
		</template>
	
	
		<!-- Structure of a combat encounter -->
		<template name="encounter_screen">
			<div class="encounter_screen modal_screen" woof-queue="info.encounter > [wt='EffectQueue']"
														wh-c="Battlefield.NewUnit>EncounterRules.OnUnitAdded"
														wh-b="">
				<!-- Info for battlefield things -->
				<info class="encounter" wh-b="Effect.Create|Effect.Destroy>GameEffectInvoker.OnNewElement">
					<effects wt="EffectQueue">
						<handlers default="GameEffectImpls.HandleDefault">
							<!-- Handlers for game behavior -->
							
							<!-- Defend Rules -->
							<handler handler="DefendRules.ReduceDefend" event-types="ReduceDefend"></handler>
							<handler handler="DefendRules.GainDefend" event-types="GainDefend"></handler>
							
							<!-- Damage Rules -->
							<handler handler="DamageRules.ReduceHP" event-types="ReduceHP"></handler>
							<handler handler="DamageRules.TakeDamage" event-types="TakeDamage"></handler>
							<handler handler="DamageRules.Die" event-types="Die"></handler>
							
							<!-- Movement Rules -->
							<handler handler="MovementRules.WalkUnit" event-types="WalkUnit"></handler>
							<handler handler="MovementRules.StepUnit" event-types="StepUnit"></handler>
							<handler handler="MovementRules.MoveUnit" event-types="MoveUnit"></handler>
							
							<!-- Initiative Rules -->
							<handler handler="InitiativeRules.AdjustUnitInitiative" event-types="AdjustUnitInitiative"></handler>							
							<handler handler="InitiativeRules.DelayUnit" event-types="DelayUnit"></handler>							
							<handler handler="InitiativeRules.DelayAll" event-types="DelayAll"></handler>							
							
							<!-- Influence Rules -->
							<handler handler="InfluenceRules.OnAfterMoveUnit" event-types="MoveUnit:after"></handler>

							<!-- Turns/Actions Rules -->
							<handler handler="ActionRules.InvokeAction" event-types="InvokeAction"></handler>
							
							
							
							<!-- Handlers for UI Effects -->
							<handler handler="UiTreatments.OnAfterUiEffect" event-types="TakeDamage:after" target-fn="UiTreatments.ResultToUnit">
								<ui-effect type="blink" blink-color="red"></ui-effect>
								<ui-effect type="wub" icon="🤕"></ui-effect>
							</handler>
							<handler handler="UITreatments.OnAfterUiEffect" event-types="GainDefend:after"  target-fn="UiTreatments.ResultToUnit">
								<ui-effect type="wub" icon="🛡️"></ui-effect>
							</handler>
							<handler handler="UiTreatments.OnAfterUiEffect" event-types="StepUnit:after"></handler> <!-- Adds a delay between steps -->
							
						</handlers>
						<queue wh-c=".AddChild|.RemoveChild>GameEffect.OnChildChange">
						</queue>
					</effects>
				</info>
				<div class="battlefield_widget_container"
					wh-c=""></div>
				<div class="preview_panel">
					<div class="move_preview">
						<div class="title">Move Preview</div>
						<div class="default">Select some cards!!</div>
						<div class="content"></div>
					</div>
					<div class="trigger_preview">
						<div class="title">Trigger Preview</div>
						<div class="default">This unit can't do anything.</div>
						<div class="content"></div>
					</div>
					<info class="base"></info>
				</div>
				<div wt="CardHud" class="card_hud_widget" wh-c="CardSet.AddChild|CardSet.RemoveChild|CardSet.MoveFrom|CardSet.MoveTo>CardHud.OnContentChange"></div>
			</div>
		</template>
				
		<!-- Structure of initiative tracker -->
		<template name="initiative_tracker">
			<div wt="InitiativeTracker" class="initiative_tracker" wh-c="InitEntry.Create|InitEvent.Destroy|InitEvent.MoveTo|InitEvent.MoveFrom>InitiativeTracker.OnChange,
																		 InitiativeTracker.Attr:current>InitiativeTracker.OnAttrChange">
				<div class="initiative_tracker_decor">INITIATIVE</div>
				<div class="initiative_tracker_contents">
				</div>
				<div class="initiative_doodad">
				</div>
			</div>
		</template>
		
		<!-- Structure of initiative tracker -->
		<template name="initiative_entry">
			<div wt="InitEntry" class="initiative_entry" unit="UNIT" highlight-ref="[unit-id='UNIT']">VALUE</div>
		</template>

		<!-- For the engine. -->
		<template name="game_effect">
			<game-effect w-id="ID" wt="Effect" type="TYPE" phase="before">
				<queue></queue>
			</game-effect>
		</template>
		
		<!-- Template for an icon that grows, then disappears. -->
		<template name="icon_wub_ui_effect">
			<div wt="UiEffect" class="wub_ui_effect" wh-b="UiEffect.Create>UiTreatments.OnTempIconCreate">
			  CONTENT
			</div>
		</template>
		
		<!-- Structure of our card HUD -->
		<template name="card_hud">
			<div class="deck">
			  <div wt="CardSet DrawPile" class="content" team-id="Player"></div>
			  <div class="size"></div>
			</div>
			<div class="discard">
			  <div wt="CardSet Discard" class="content" team-id="Player"></div>
			  <div class="size"></div>
			</div>
			<div wt="HandRules" class="hand" at-least="5" at-most="10" wh-c=".click>CardHud.OnCardSelect">
			  <div wt="CardSet Hand" class="content" team-id="Player"></div>
			  <div class="size"></div>
			</div>
			<div class="disabled_blocker"></div>
		</template>	
		
		<!-- Structure of our message log -->
		<template name="message_log">
			<div wt="MessageLog" class="message_log" wh-c="TestConsoleInput.keydown>TestConsole.OnKeyDown,MessageLog.Attr:wlogger-allow>TestConsole.OnLoggerLevelChange,MLLS.change>TestConsole.OnLoggerLevelCheckboxChange" wlogger="TestConsole.PostMessage" wlogger-allow="RAW TRACE INFO WARN ERR">
				<div class="log_history  text">
				</div>
				<input wt="TestConsoleInput" type="text" placeholder="Enter console command" class="console_input" />
				<div class="log_level_selectors">
				  <label><input wt="MLLS" type="checkbox" level="RAW" />Raw</label>
				  <label><input wt="MLLS" type="checkbox" level="TRACE" />Trace</label>
				  <label><input wt="MLLS" type="checkbox" level="INFO" />Info</label>
				  <label><input wt="MLLS" type="checkbox" level="WARN" />Warn</label>
				  <label><input wt="MLLS" type="checkbox" level="ERR" />Err</label>
				</div>
				
				<div class="message_log_past_entries" style="display:none"></div>
			</div>
		</template>
		
		<template name="message_log_history">
			<div>VALUE</div>
		</template>
		
		<!-- Structure of a single message -->
		<template name="log_entry">
			<div class="log_entry">
				CONTENT
			</div>
		</template>
		
		<!-- Team info, to go in the battlefield info blob -->
		<template name="team_info">
			<team-info w-id="TEAM_ID" controller="CONTROLLER"></team-info>		
		</template>
		
		<!-- Team info, to go in the battlefield info blob -->
		<template name="opponent_info">
			<team-info team-id=""></team-info>		
		</template>		
		
		<!-- Battlefield Root -->
		<template name="battlefield_wrapper">
			<div wt="Battlefield" class="battlefield_widget" effect-container=":scope > .ui_effect_overlay"
					wh-b=".Attr:coordinate>Battlefield.OnOverlayItemMove,
						  BattleOverlay.AddChild>Battlefield.OnOverlayItemAdd,
						  BattleOverlay.RemoveChild>Battlefield.OnOverlayItemRemove">
				<div id="battle_grid" class="battlefield_widget_inner"></div>
				<div wt="BattleOverlay" id="battle_overlay" class="battlefield_widget_overlay"></div>
				<div class="ui_effect_overlay"></div>
			</div>
		</template>
		
		<!-- Battlefield unit -->
		<template name="battlefield_unit">
			<div class="battlefield_unit" wt="Unit" unit-id="ID" highlight-scroll-to="true" compendium="unit"
					team-id="AI" 
					wh-c="HPBar.Attr:value|HPBar.Attr:max>Unit.OnHPBarUpdate">

				<div class="appearance no_transition">APPEARANCE</div>
				<div class="support">👪️</div>
				<div class="flank">🎯</div>
				<div class="hp_tracker">
					<progress class="hp_bar" wt="HPBar" max="30" value="30"> </progress>
					<div class="hp_text">30/30</div>
					<div class="defend"><div class="decor">🛡️</div><div class="content"></div></div>
				</div>
				<div class="intent_tracker">
					<div wt="CardSet IntentHand" unit-id="ID" class="content"></div>
				</div>
				<info class="unit">
					<trigger wt="Trigger" priority="9" active-test="SingleTrigger.SuitRankActive" suit-filter="joker" rank-filter="0" renderer="TriggerRenderer.Single">
						<move-ref ref="Swap"></move-ref>
					</trigger> 

					<trigger wt="Trigger"  priority="5" active-test="SingleTrigger.SuitActive" suit-filter="spade club" renderer="TriggerRenderer.Single">
						<move-ref ref="Strike"></move-ref>
					</trigger>
					
					<trigger wt="Trigger" priority="5" active-test="SingleTrigger.SuitActive" suit-filter="spade club" renderer="TriggerRenderer.Single">
						<move-ref ref="Shout"></move-ref>
					</trigger>
					
					<trigger wt="Trigger" priority="5" active-test="SingleTrigger.SuitActive" suit-filter="heart diamond" renderer="TriggerRenderer.Single">
						<move-ref ref="Defend"></move-ref>
					</trigger>

					<trigger wt="Trigger" priority="5" active-test="SingleTrigger.SuitActive" suit-filter="heart diamond" renderer="TriggerRenderer.Single">
						<move-ref ref="Walk"></move-ref>
					</trigger>
					
					<trigger wt="Trigger" priority="1" active-test="SingleTrigger.AnyActive" renderer="TriggerRenderer.Single">
						<move-ref ref="Step"></move-ref>
					</trigger>
					
					
					<!-- Default AI dials. -->
					<ai-dial name="intent_hand_size" value="3" type="int"></ai-dial>

					<ai-dial name="multistrike_priority" value="1.0" type="number" ref="Multistrike"></ai-dial>
					<ai-dial name="strike_priority" value=".5" type="number" ref="Strike"></ai-dial>
					<ai-dial name="walk_priority" value=".4" type="number" ref="Walk"></ai-dial>
					<ai-dial name="defend_priority" value=".3" type="number" ref="Defend"></ai-dial>
					<ai-dial name="step_priority" value=".2" type="number" ref="Step"></ai-dial>
					<ai-dial name="struggle_priority" value=".01" type="number" ref="Struggle"></ai-dial>
					<ai-dial name="struggle_priority" value="0" type="number" ref="Swap"></ai-dial>


				</info>

				
			</div>
		</template>
		
		<template name="ai_dial">
			<ai-dial name="NAME" value="VALUE"></ai-dial>
		</template>

		
		<!-- Battlefield Table -->
		<template name="battlefield_root">
			<div class="battlefield_root">
				<div class="battlefield_header">
					<div class="battlefield_label"></div>
					<div class="battlefield_edge"></div>
				</div>
				<div class="battlefield_transition_row">
					<div class="battlefield_label"></div>
					<div class="battlefield_point"></div>
				</div>
			</div>	
		</template>
		
		<!-- Battlefield headers -->
		<template name="battlefield_header_cells">
			<div class="battlefield_header_cell">LAY-BOH</div>
			<div class="battlefield_edge"></div>			
		</template>

		<!-- Battlefield row block -->
		<template name="battlefield_rows">
			<div class="battlefield_row">
				<div class="battlefield_label">LAY-BOH</div>
				<div class="battlefield_edge"></div>
			</div>
			<div class="battlefield_transition_row">
				<div class="battlefield_label"></div>
				<div class="battlefield_point"></div>
			</div>
		</template>

		<!-- Battlefield cell block. -->
		<template name="battlefield_cells">
			<div class="battlefield_cell" x="X-LU", y="Y-LU", label="LAY-BOH"></div>
			<div class="battlefield_edge"></div>			
		</template>

		<!-- Battlefield transition block. -->
		<template name="battlefield_transition_cells">
			<div class="battlefield_edge"></div>
			<div class="battlefield_point"></div>			
		</template>
	</div>
	
	<!-- Trigger code at the bottom -->
	<script>
	
	// Register our document root to be handled by the framework.
	WoofRootController.addRoot(document.body, [
	  "hashchange"
	]);

	// Create a console widget where appropriate.
	var consoleContainerBoy = document.querySelector(".console_widget")
	TestConsole.create(consoleContainerBoy);
	TestConsole.focus(consoleContainerBoy);
			
	var mainScreen = document.getElementsByClassName("main_screen")[0];		
	// Initialize our main screen handler.
		
	// Run whatever test you wanted to run.
	
	if (window.location.hash) {
		InfoPanel.navigateTo(document.body, window.location.hash.toLowerCase().substring(1));
	}
	
	</script>
</body>

</html>